import pandas as pd
import pyodbc

# ✅ STEP 1: Give the correct path to your CSV file
csv_path = r"C:\Users\Vanshul\amazon_inventory\suppliers_data.csv"

# ✅ STEP 2: Read CSV into pandas DataFrame
data = pd.read_csv(csv_path)

# ✅ STEP 3: Connect to SQL Server
conn = pyodbc.connect(
    'DRIVER={SQL Server};'
    'SERVER=localhost;'          # change if your server name is different
    'DATABASE=InventoryDB;'
    'Trusted_Connection=yes;'
)

cursor = conn.cursor()

# ✅ STEP 4: Insert each record into Suppliers table
for index, row in data.iterrows():
    cursor.execute("""
        INSERT INTO Suppliers 
        (supplier_name, contact_person, phone_number, email, address, city, state, postal_code, country)
        VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
    """,
    row['supplier_name'], row['contact_person'], row['phone_number'],
    row['email'], row['address'], row['city'], row['state'],
    row['postal_code'], row['country'])

# ✅ STEP 5: Commit and close
conn.commit()
cursor.close()
conn.close()

print("✅ Data successfully inserted into the Suppliers table!")
